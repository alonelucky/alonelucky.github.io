{
    "version": "https://jsonfeed.org/version/1",
    "title": "小码农博客 • All posts by \"npm\" tag",
    "description": null,
    "home_page_url": "http://qiubo.ink",
    "items": [
        {
            "id": "http://qiubo.ink/2017/09/14/Verdaccio%E6%90%AD%E5%BB%BAnpm%E7%A7%81%E6%9C%89%E4%BB%93%E5%BA%93/",
            "url": "http://qiubo.ink/2017/09/14/Verdaccio%E6%90%AD%E5%BB%BAnpm%E7%A7%81%E6%9C%89%E4%BB%93%E5%BA%93/",
            "title": "Verdaccio 搭建npm私有仓库",
            "date_published": "2017-09-14T11:56:01.000Z",
            "content_html": "<p>使用Nodejs的过程中未免会遇到公司项目私有化开发，此时需要一些私有模块的发布和使用，<code>npmjs</code>的私有仓库是付费的功能,<code>cnpm</code>本地搭建又偏重，<code>verdaccio</code>项目刚好满足，轻量私有部署简单</p>\n<span id=\"more\"></span>\n\n<p>由于<code>sinopia</code>项目不再维护,故选取fork项目<code>verdaccio</code>进行搭建,使用方法一样,仅仅将<code>sinopia</code>换为<code>verdaccio</code></p>\n<p>环境依赖</p>\n<p>python 2.7.x<br>node-gyp</p>\n<h3 id=\"1-安装verdaccio\"><a href=\"#1-安装verdaccio\" class=\"headerlink\" title=\"1. 安装verdaccio\"></a>1. 安装verdaccio</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm i -g verdaccio</span><br><span class=\"line\"></span><br><span class=\"line\">配置文件 ~/.config/verdaccio/config.yaml</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 存放位置</span></span><br><span class=\"line\">storage: ./npmdata</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 认证</span></span><br><span class=\"line\">auth:</span><br><span class=\"line\">\thtpasswd:</span><br><span class=\"line\">\t\tfile:./authpasswd</span><br><span class=\"line\">\t\tmax_users:10</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 抓取镜像源</span></span><br><span class=\"line\">uplinks</span><br><span class=\"line\">\tnpmjs:</span><br><span class=\"line\">\t\turl:http://registry.npm.taobao.org/</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># package</span></span><br><span class=\"line\">packages:</span><br><span class=\"line\">\t<span class=\"string\">&quot;@*/*&quot;</span>:</span><br><span class=\"line\">\t\taccess:<span class=\"variable\">$all</span></span><br><span class=\"line\">\t\tpublish:<span class=\"variable\">$authenticated</span></span><br><span class=\"line\">\t<span class=\"string\">&quot;*&quot;</span>:</span><br><span class=\"line\">\t\taccess:<span class=\"variable\">$all</span></span><br><span class=\"line\">\t\tpublish:<span class=\"variable\">$authenticated</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 日志</span></span><br><span class=\"line\">logs:</span><br><span class=\"line\">\t- &#123;<span class=\"built_in\">type</span>:stdout,format:pretty,level:http,path:./npm.log&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 监听端口(默认没有这个选项监听4873端口)</span></span><br><span class=\"line\">listen:\t0.0.0.0:4433</span><br></pre></td></tr></table></figure>\n<h3 id=\"2-启动项目\"><a href=\"#2-启动项目\" class=\"headerlink\" title=\"2. 启动项目\"></a>2. 启动项目</h3><ol>\n<li>默认启动<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">verdaccio</span><br><span class=\"line\"><span class=\"comment\"># 默认加载 ~/.config/verdaccio/config.yaml</span></span><br><span class=\"line\"><span class=\"comment\"># 默认监听</span></span><br><span class=\"line\"><span class=\"comment\"># 默认存储位置 ~/.config/verdaccio/storage/</span></span><br><span class=\"line\"><span class=\"comment\"># 默认账号密码存放位置 ~/.config/verdaccio/htpasswd</span></span><br></pre></td></tr></table></figure></li>\n<li>终端命令启动</li>\n</ol>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">verdaccio -l 端口 -c 配置文件位置</span><br></pre></td></tr></table></figure>\n\n<ol start=\"3\">\n<li>pm2进程守护</li>\n</ol>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pm2 start `<span class=\"built_in\">which</span> verdaccio` --name <span class=\"string\">&quot;local_npm&quot;</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"3-项目使用\"><a href=\"#3-项目使用\" class=\"headerlink\" title=\"3. 项目使用\"></a>3. 项目使用</h3><ol>\n<li>修改源<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm <span class=\"built_in\">set</span> registry http://0.0.0.0:4433</span><br></pre></td></tr></table></figure></li>\n<li>增加用户</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm adduser --registry http://0.0.0.0:4433</span><br><span class=\"line\">Username:</span><br><span class=\"line\">Passwd:</span><br><span class=\"line\">Emial:</span><br></pre></td></tr></table></figure>\n<ol>\n<li>发布包 和发布到npm仓库一样,登录,发布</li>\n</ol>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm login</span><br><span class=\"line\">npm publish</span><br></pre></td></tr></table></figure>\n<ol>\n<li>安装包</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install @xxx/yyy</span><br></pre></td></tr></table></figure>\n<h3 id=\"4-注\"><a href=\"#4-注\" class=\"headerlink\" title=\"4. 注\"></a>4. 注</h3><p>使用 <code>nrm</code> 管理源 使用 nrm 增加源</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nrm add nl http://0.0.0.0:4433</span><br></pre></td></tr></table></figure>\n<p>使用 nrm 切换源</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nrm use nl</span><br></pre></td></tr></table></figure>\n<p>浏览 nrm 源</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nrm ls</span><br></pre></td></tr></table></figure>",
            "tags": [
                "npm"
            ]
        }
    ]
}